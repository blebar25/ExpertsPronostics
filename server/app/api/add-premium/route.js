"use strict";(()=>{var e={};e.id=1689,e.ids=[1689],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},29219:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>w,originalPathname:()=>g,patchFetch:()=>A,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>D,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>P});var a={};r.r(a),r.d(a,{POST:()=>l});var n=r(95419),o=r(69108),i=r(99678),s=r(78070),u=r(9108);let d={STANDARD:"STANDARD",PREMIUM:"PREMIUM"};async function l(e){try{let e=await u.Z.user.findUnique({where:{email:"premium@test.com"}});if(!e)return s.Z.json({error:"Utilisateur non trouv\xe9"},{status:404});console.log("Utilisateur trouv\xe9:",e);let t=await u.Z.subscription.findFirst({where:{userId:e.id}});if(console.log("Abonnement existant:",t),t){let e=await u.Z.subscription.update({where:{id:t.id},data:{type:d.PREMIUM,startDate:new Date,endDate:new Date(Date.now()+2592e6),active:!0,lastPaymentDate:new Date}});return console.log("Abonnement mis \xe0 jour:",e),s.Z.json({message:"Abonnement mis \xe0 jour",subscription:e})}let r=await u.Z.subscription.create({data:{userId:e.id,type:d.PREMIUM,startDate:new Date,endDate:new Date(Date.now()+2592e6),active:!0,lastPaymentDate:new Date}});return console.log("Nouvel abonnement cr\xe9\xe9:",r),s.Z.json({message:"Abonnement cr\xe9\xe9",subscription:r})}catch(e){return console.error("Erreur d\xe9taill\xe9e:",e),s.Z.json({error:"Erreur serveur",details:e instanceof Error?e.message:String(e)},{status:500})}}d.STANDARD,d.STANDARD,d.PREMIUM,d.PREMIUM;let p=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/add-premium/route",pathname:"/api/add-premium",filename:"route",bundlePath:"app/api/add-premium/route"},resolvedPagePath:"/home/runner/work/ExpertsPronostics/ExpertsPronostics/app/api/add-premium/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:c,serverHooks:D,headerHooks:w,staticGenerationBailout:P}=p,g="/api/add-premium/route";function A(){return(0,i.patchFetch)({serverHooks:D,staticGenerationAsyncStorage:c})}},9108:(e,t,r)=>{r.d(t,{Z:()=>n});let a=require("@prisma/client"),n=global.prisma||new a.PrismaClient({log:["query"]})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[1638,6206],()=>r(29219));module.exports=a})();