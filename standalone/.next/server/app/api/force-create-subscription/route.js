"use strict";(()=>{var e={};e.id=1757,e.ids=[1757],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39098:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>b,originalPathname:()=>w,patchFetch:()=>h,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>f});var n={};t.r(n),t.d(n,{POST:()=>c});var a=t(95419),s=t(69108),i=t(99678),o=t(78070),u=t(9108);async function c(e){try{let{email:r,type:t}=await e.json();if(!r||!t)return o.Z.json({error:"Email et type d'abonnement requis"},{status:400});if(!["STANDARD","PREMIUM"].includes(t))return o.Z.json({error:"Type d'abonnement invalide"},{status:400});let n=await u.Z.user.findUnique({where:{email:r},include:{subscription:!0}});if(!n)return o.Z.json({error:"Utilisateur non trouv\xe9"},{status:404});if(n.subscription&&n.subscription.active)return o.Z.json({error:"L'utilisateur a d\xe9j\xe0 un abonnement actif"},{status:400});let a=await u.Z.subscription.create({data:{userId:n.id,type:t,startDate:new Date,endDate:new Date(Date.now()+31536e6),active:!0,lastPaymentDate:new Date}}),s=await u.Z.user.findUnique({where:{email:r},include:{subscription:!0}});return o.Z.json({message:"Abonnement cr\xe9\xe9 avec succ\xe8s",user:s,subscription:a})}catch(e){return console.error("Erreur lors de la cr\xe9ation de l'abonnement:",e),o.Z.json({error:"Erreur lors de la cr\xe9ation de l'abonnement"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/force-create-subscription/route",pathname:"/api/force-create-subscription",filename:"route",bundlePath:"app/api/force-create-subscription/route"},resolvedPagePath:"/home/runner/work/ExpertsPronostics/ExpertsPronostics/app/api/force-create-subscription/route.ts",nextConfigOutput:"standalone",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m,headerHooks:b,staticGenerationBailout:f}=p,w="/api/force-create-subscription/route";function h(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},9108:(e,r,t)=>{t.d(r,{Z:()=>a});let n=require("@prisma/client"),a=global.prisma||new n.PrismaClient({log:["query"]})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[1638,6206],()=>t(39098));module.exports=n})();