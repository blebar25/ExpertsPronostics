(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{4177:function(e,s,a){Promise.resolve().then(a.bind(a,9939))},9939:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return i}});var t=a(3827),r=a(1126),n=a(7907),l=a(4090);function i(){var e,s;let{data:a,status:i}=(0,r.useSession)(),d=(0,n.useRouter)(),[o,c]=(0,l.useState)(""),[u,m]=(0,l.useState)(""),[h,x]=(0,l.useState)(""),[p,f]=(0,l.useState)(""),[b,g]=(0,l.useState)(""),[j,v]=(0,l.useState)(null),[N,w]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=async()=>{var e;if(null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.id)try{let e=await fetch("/api/subscription-details"),s=await e.json();v(s.subscription)}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des d\xe9tails de l'abonnement:",e)}finally{w(!1)}else w(!1)};"authenticated"===i&&e()},[a,i]);let y=async e=>{if(e.preventDefault(),u!==h){f("Les mots de passe ne correspondent pas");return}try{let e=await fetch("/api/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:o,newPassword:u})}),s=await e.json();e.ok?(g("Mot de passe modifi\xe9 avec succ\xe8s"),c(""),m(""),x(""),f("")):f(s.error||"Une erreur est survenue")}catch(e){f("Une erreur est survenue lors de la modification du mot de passe")}};return"loading"===i||N?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-blue-500"})}):"unauthenticated"===i?(d.push("/auth/login"),null):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 pt-24 pb-24 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"max-w-3xl mx-auto space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"Profil Utilisateur"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600",children:"Email"}),(0,t.jsx)("p",{className:"font-medium",children:null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600",children:"Nom"}),(0,t.jsx)("p",{className:"font-medium",children:(null==a?void 0:null===(s=a.user)||void 0===s?void 0:s.name)||"Non d\xe9fini"})]}),j?(0,t.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"D\xe9tails de l'abonnement"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Type : "}),(0,t.jsx)("span",{className:"font-medium",children:j.type})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Statut : "}),(0,t.jsx)("span",{className:"font-medium ".concat(j.active?"text-green-600":"text-red-600"),children:j.active?"Actif":"Inactif"})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Date de d\xe9but : "}),(0,t.jsx)("span",{className:"font-medium",children:new Date(j.startDate).toLocaleDateString()})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Date de fin : "}),(0,t.jsx)("span",{className:"font-medium",children:new Date(j.endDate).toLocaleDateString()})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Dernier paiement : "}),(0,t.jsx)("span",{className:"font-medium",children:new Date(j.lastPaymentDate).toLocaleDateString()})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-6",children:["STANDARD"===j.type&&(0,t.jsx)("button",{onClick:()=>window.location.href="/api/upgrade-subscription",className:"bg-yellow-400 text-black px-4 py-2 rounded-lg font-medium hover:bg-yellow-300 transition-colors",children:"Passer Premium"}),(0,t.jsxs)("div",{className:"flex space-x-4 text-sm",children:["PREMIUM"===j.type&&(0,t.jsx)("button",{onClick:()=>window.location.href="/api/downgrade-subscription",className:"text-gray-500 hover:text-gray-600 transition-colors",children:"Passer Standard"}),(0,t.jsx)("button",{onClick:()=>window.location.href="/api/cancel-subscription",className:"text-red-500 hover:text-red-600 transition-colors",children:"Annuler"})]})]})]}):(0,t.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,t.jsx)("p",{className:"text-gray-600",children:"Aucun abonnement actif"})})]})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Changer le mot de passe"}),(0,t.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[p&&(0,t.jsx)("div",{className:"bg-red-50 text-red-700 p-3 rounded",children:p}),b&&(0,t.jsx)("div",{className:"bg-green-50 text-green-700 p-3 rounded",children:b}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700",children:"Mot de passe actuel"}),(0,t.jsx)("input",{type:"password",id:"currentPassword",value:o,onChange:e=>c(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700",children:"Nouveau mot de passe"}),(0,t.jsx)("input",{type:"password",id:"newPassword",value:u,onChange:e=>m(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirmer le nouveau mot de passe"}),(0,t.jsx)("input",{type:"password",id:"confirmPassword",value:h,onChange:e=>x(e.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",required:!0})]}),(0,t.jsx)("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Changer le mot de passe"})]})]})]})})}},7907:function(e,s,a){"use strict";var t=a(5313);a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[126,971,69,744],function(){return e(e.s=4177)}),_N_E=e.O()}]);